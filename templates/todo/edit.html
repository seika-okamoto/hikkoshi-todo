<p><a href="{% url 'todo:index' %}">ğŸ”™æˆ»ã‚‹ </a></p>

<h2>ToDoãƒªã‚¹ãƒˆï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼‰</h2>
<ul>
  {% for task in tasks %}
    <li>
      {{ task.title }}
      <button class="edit-btn" data-task-id="{{ task.id }}">ç·¨é›†</button>
      <button class="delete-btn" data-task-id="{{ task.id }}">å‰Šé™¤</button>

      <!-- ç·¨é›†ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« -->
      <div class="modal edit-modal" id="edit-modal-{{ task.id }}" style="display:none;">
        <form method="POST" action="{% url 'todo:edit_task' task.id %}">
          {% csrf_token %}
          <input type="text" name="title" value="{{ task.title }}">
          <button type="submit">ä¿å­˜</button>
          <button type="button" class="cancel-btn">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        </form>
      </div>

      <!-- å‰Šé™¤ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« -->
      <div class="modal delete-modal" id="delete-modal-{{ task.id }}" style="display:none;">
        <p>ã“ã®é …ç›®ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</p>
        <form method="POST" action="{% url 'todo:delete_task' task.id %}">
          {% csrf_token %}
          <button type="submit">å‰Šé™¤</button>
          <button type="button" class="cancel-btn">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        </form>
      </div>
    </li>
  {% endfor %}
</ul>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // ç·¨é›†ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    document.querySelectorAll('.edit-btn').forEach(function (btn) {
      btn.addEventListener('click', function () {
        const taskId = btn.dataset.taskId;
        document.getElementById('edit-modal-' + taskId).style.display = 'block';
      });
    });

    // å‰Šé™¤ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    document.querySelectorAll('.delete-btn').forEach(function (btn) {
      btn.addEventListener('click', function () {
        const taskId = btn.dataset.taskId;
        document.getElementById('delete-modal-' + taskId).style.display = 'block';
      });
    });

    // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    document.querySelectorAll('.cancel-btn').forEach(function (btn) {
      btn.addEventListener('click', function () {
        btn.closest('.modal').style.display = 'none';
      });
    });
  });
</script>
