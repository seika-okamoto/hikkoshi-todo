{% extends 'base.html' %}

{% block content %}
  <p><a href="{% url 'todo:index' %}">🔙戻る</a></p>

  <h2>{{ task.title }}</h2>

  <!-- タブ切り替えボタン -->
  <p>
    <a href="?view=memo" {% if view == "memo" %}style="font-weight:bold;"{% endif %}>メモ</a> |
    <a href="?view=comment" {% if view == "comment" %}style="font-weight:bold;"{% endif %}>コメント</a>
  </p>

  <!-- 表示内容 -->
  {% if view == "memo" %}
    <h3>メモ</h3>
    <ul>
      {% for memo in memos %}
        <li>{{ memo.context }}（{{ memo.created|date:"Y/m/d H:i" }}）</li>
    {% empty %}
      <li>メモはまだありません。</li>
      {% endfor %}
    </ul>
    <form method="POST" action="{% url 'todo:add_memo' task.id %}">
        {% csrf_token %}
        <textarea name="context" rows="3" cols="40" placeholder="メモを入力"></textarea>
        <br>
        <button type="submit">+ メモを追加</button>
      </form>
    {% endif %}

  {% if view == "comment" %}
    <h3>コメント</h3>
    <ul>
      {% for comment in comments %}
       <li>{{ comment.content }}（{{ comment.created_at|date:"Y/m/d H:i" }}）</li>
      {% empty %}
        <li>コメントはまだありません。</li>
      {% endfor %}
   </ul>

    <form method="POST" action="{% url 'todo:add_comment' task.id %}">
     {% csrf_token %}
      <textarea name="content" rows="3" cols="40" placeholder="コメントを入力"></textarea>
      <br>
      <button type="submit">+ コメントを追加</button>
    </form>
  {% endif %}

  {% endblock %}

